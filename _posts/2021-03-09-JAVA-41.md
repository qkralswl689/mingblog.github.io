---
layout: post
title: "JAVA -JDBC í”„ë¡œê·¸ëž˜ë° - DBì—°ê²°/í•´ì œ"
date: 2021-03-09
category : [JAVA]
comments: true
---

## ðŸ”·JDBC í”„ë¡œê·¸ëž˜ë° - DBì—°ê²°/í•´ì œ

### âœ” JDBC

    -  ìžë°” í”„ë¡œê·¸ëž¨ ì•ˆì—ì„œ SQLì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•´ì£¼ëŠ” ì‘ìš©í”„ë¡œê·¸ëž¨ ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ ë§í•œë‹¤.

- ì˜ˆì œ 1)
    ```java
    package JdbcTest;

    import java.sql.Connection;
    import java.sql.DriverManager;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;
    import java.sql.SQLException;

    /**
    * DB ì—°ê²°/í•´ì œ(ìžì› ë°˜ë‚©) ìœ í‹¸ë¦¬í‹°
    * 
    * @author javateam
    *
    */
    public class DbUtil {
        
        /**
        * DB ì—°ê²°
        * 
        * usage) DbUtil.connect();
        * 
        * @return DB ì—°ê²° ê°ì²´
        */
        public static Connection connect() {
            
            Connection con = null; // DB ì—°ê²° ê°ì²´
            // final String driver = "oracle.jdbc.driver.OracleDriver";
            final String driver = "oracle.jdbc.OracleDriver"; // JDBC ë“œë¼ì´ë²„
            final String url = "jdbc:oracle:thin:@localhost:1521:xe"; // JDBC URL
            final String id = "hr"; // ê³„ì • ì•„ì´ë””
            final String pw = "hr"; // ê³„ì • íŒ¨ì“°ì›Œë“œ
            
            try {
                    // JDBC driver ê²€ìƒ‰/ë¡œë”©(loading)
                    Class.forName(driver);
                    // DB ì—°ê²° ê°ì²´ ë°˜í™˜(DB ì—°ê²°)
                    con = DriverManager.getConnection(url, id, pw);
                    
            } catch (ClassNotFoundException e) {
                System.out.println("DbUtil connect CNFE :");
                e.printStackTrace();
            } catch(SQLException e) {
                System.out.println("DbUtil connect SE : ");
                e.printStackTrace();
            }
            
            return con;
        } //
        
        /**
        * DB ì—°ê²° í•´ì œ(ìžì› ë°˜ë‚©)
        * 
        * @param con DB ì—°ê²° ê°ì²´
        * @param pstmt SQL ì²˜ë¦¬ ê°ì²´
        * @param rs SQL ì²˜ë¦¬ ê²°ê³¼ì…‹
        */
        public static void close(Connection con,
                                PreparedStatement pstmt,
                                ResultSet rs) {
            try {
                    if (rs != null) rs.close();
                    // if (!rs.isClosed()) rs.close();
                    if (pstmt != null) pstmt.close();
                    if (con != null) con.close();
                    
            } catch(SQLException e) {
                System.out.println("DbUtil close SE : ");
                e.printStackTrace();
            } // 
                    
        } //

    }
    ```
    
- ì˜ˆì œ 2)
    ```java
    package JdbcTest;

    import java.sql.Connection;
    import java.sql.DriverManager;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;
    import java.sql.SQLException;
    import java.sql.Statement;
    
    public class JDBCTest {
    
        // oracle spec
        // jdbc:oracle:thin:@localhost:1521:xe : hr -> ì˜¤ë¥¸ìª½ë§ˆìš°ìŠ¤ -> ì˜¤ë¼í´ Properties => ë“œë¼ì´ë²„ Properties
        // ì•„ëž˜ 4ê°€ì§€ : jdbcì—°ê²°ì‹œ í•„ìš”í•œê²ƒ 
        final String oracleDriver = "oracle.jdbc.OracleDriver"; // ë“œë¼ì´ë²„
        final String oracleURL = "jdbc:oracle:thin:@localhost:1521:xe"; // URL
        final String oracleID = "hr"; // ê³„ì • ì•„ì´ë””
        final String oraclePW = "hr"; // íŒ¨ì“°ì›Œë“œ
    
        // DB ì—°ê²°(connection)
        // getConnection() : ì—°ê²°
        public Connection getConnection() {
    
            Connection con = null;
    
            try {
                // forName ìžˆë‚˜ ì—†ë‚˜ í™•ì¸ => JDBC ë“œë¼ì´ë²„ ë“±ë¡
                Class.forName(oracleDriver);
                // DB ì—°ê²°
                con = DriverManager.getConnection(oracleURL, oracleID, oraclePW);
                // ì˜ˆì™¸ì²˜ë¦¬ í•„ìˆ˜            
            } catch (ClassNotFoundException e) {
                System.out.println("jdbc ë“œë¼ì´ë²„ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
                // System.err.println("jdbc ë“œë¼ì´ë²„ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"); (O)
                e.printStackTrace();
            } catch (SQLException e) {
                System.out.println("Oracle DB ì—°ê²°ì— ì‹¤íŒ¨ í•˜ì˜€ìŠµë‹ˆë‹¤");
                // System.err.println("Oracle DB ì—°ê²°ì— ì‹¤íŒ¨ í•˜ì˜€ìŠµë‹ˆë‹¤"); (O)
                e.printStackTrace();
            }
            
            // return í•„ìˆ˜! => null ë„£ìœ¼ë©´ ì•ˆë¨!
            return con;
        }

            // ì—°ê²° ì˜ˆì™¸ì²˜ë¦¬ throwsë¡œ ì²˜ë¦¬í•œ ê²½ìš°
    //        public Connection getConnection() throws ClassNotFoundException,SQLException{
    // 
    //        Connection con = null;
    //        Class clazz = Class.forName(oracleDriver);
    //        if(clazz == null) {
    //        	throw new ClassNotFoundException ("Oracle DB ì—°ê²°ì— ì‹¤íŒ¨ í•˜ì˜€ìŠµë‹ˆë‹¤");
    //        }
    //        
    //            Class.forName(oracleDriver);
    //            con = DriverManager.getConnection(oracleURL, oracleID, oraclePW);
    //            if(con == null) {
    //            	throw new SQLException("Oracle DB ì—°ê²°ì— ì‹¤íŒ¨ í•˜ì˜€ìŠµë‹ˆë‹¤");
    //            }
    //        
    //        // return í•„ìˆ˜! => null ë„£ìœ¼ë©´ ì•ˆë¨!
    //        return con;
    //    }
    
        // 
        public void getTable() {
    
            
            // Connection con = null; // 1) ëŒ€ì‹     	
            Connection con = this.getConnection(); // ë°”ë¡œ ì²˜ë¦¬í•´ë„ ëœë‹¤ => ìœ„ì—ì„œ ì˜ˆì™¸ì²˜ë¦¬ í–ˆê¸° ë•Œë¬¸ì—, thisìƒëžµê°€ëŠ¥ => DB ì—°ê²° ê°ì²´
            
            // SQL ì²˜ë¦¬ ê°ì²´
            Statement pstmt = null; // SQL ì²˜ë¦¬ 2)  import -> java.sql.Statement;
            //PreparedStatement pstmt = null; // SQL ì„ ì²˜ë¦¬ 3) 
            
            // SQL ì²˜ë¦¬ ê²°ê³¼ì…‹ ê°ì²´
            ResultSet rs = null;
            
            // SQL êµ¬ë¬¸ , ëŒ€ ì†Œë¬¸ìž êµ¬ë¶„ X => ê°€ë…ì„±ì„ ìœ„í•´ ëŒ€ë¬¸ìž,ì†Œë¬¸ìž ì‚¬ìš©í•œê²ƒ
            String sql = "SELECT * FROM employees"; // SQL
    
            try {
                // con = getConnection(); //1)
                pstmt = con.prepareStatement(sql); // 2)
                rs = pstmt.executeQuery(sql); // 2)
                
                //pstmt = con.prepareStatement(sql); // 3)
                // rs = pstmt.executeQuery(); // 3)
    
                // ì—¬ëŸ¬ ê°œì˜ ê²°ê³¼ì…‹ ë ˆì½”ë“œ( íŠœí”Œ, í–‰) ê²€ìƒ‰
                //while (rs.next()) { // ì „ì²´ í–‰ ê²€ìƒ‰            
                if (rs.next()) { // 1ê°œì˜ í–‰ë§Œ ê²€ìƒ‰í•œë‹¤
                    
                    // í…Œì´ë¸” í•„ë“œëŠ” ëŒ€ì†Œë¬¸ìž êµ¬ë³„ X
                // System.out.println(rs.getString("employee_id"));
                    // System.out.println(rs.getString("EMPLOYEE_ID")); 
                    System.out.println(rs.getString(1)); // í…Œì´ë¸”ì˜ ì²«ë²ˆì§¸ ì¹¼ëŸ¼(í•„ë“œ)
                    // ìœ ì˜ ) JDBC í…Œì´ë¸” index => 1ë¶€í„° ì‹œìž‘í•œë‹¤!
                }
    
                rs.close();
                pstmt.close();
                con.close();
    
            } catch (SQLException e) {
                e.printStackTrace();
            }
    
        }
    
        public static void main(String[] args) {
    
            new JDBCTest().getTable();
        }
    
    }
    ```