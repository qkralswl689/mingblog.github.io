---
layout: post
title: 'Spring in Action - 2.ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œí•˜ê¸°_ 2.1 ì •ë³´ ë³´ì—¬ì£¼ê¸°, 2.2 í¼ ì œì¶œ ì²˜ë¦¬í•˜ê¸°'
date: 2021-05-14
category: [Spring]
comments: true
---

## ğŸ”· Spring in Action - 2.ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œí•˜ê¸°\_ 2.1 ì •ë³´ ë³´ì—¬ì£¼ê¸°, 2.2 í¼ ì œì¶œ ì²˜ë¦¬í•˜ê¸°

### âœ” 2.1 ì •ë³´ ë³´ì—¬ì£¼ê¸°

    - Controller : ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì²˜ë¦¬í•œë‹¤
    - view : ë¸ŒëŸ¬ìš°ì €ì— ë³´ì—¬ì£¼ëŠ” ë°ì´í„°ë¥¼ HTMLë¡œ ë‚˜íƒ€ë‚¸ë‹¤

    ğŸˆ ë””ìì¸ í˜ì´ì§€ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ ìƒì„±í•  ì»´í¬ë„ŒíŠ¸
    - ì‹ìì¬ì˜ ì†ì„±ì„ ì •ì˜í•˜ëŠ” ë„ë©”ì¸(domain) í´ë˜ìŠ¤
    - ì‹ìì¬ ì •ë³´ë¥¼ ê°€ì ¸ì™€ ë·°ì— ì „ë‹¬í•˜ëŠ” ìŠ¤í”„ë§ MVC ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤
    - ì‹ìì¬ì˜ ë‚´ì—­ì„ ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ë³´ì—¬ì£¼ëŠ” ë·° í…œí”Œë¦¿

#### âœ” 2.1.1 ë„ë©”ì¸ ì„¤ì •í•˜ê¸°

- íƒ€ì½” ì‹ìì¬ ì •ì˜ ì½”ë“œ

  ```java
  package tacos;

  import lombok.Data;
  import lombok.RequiredArgsConstructor;

  // @data, @RequiredArgsConstructor : lombok

  // @Data : final ì†ì„±ë“¤ì„ ì´ˆê¸°í™”í•˜ëŠ” ìƒì„±ì, ê²Œí„°,ì„¸í„° ìë™ ìƒì„±
  @Data
  // @RequiredArgsConstructor : ìƒì„±ìë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤
  @RequiredArgsConstructor

  public class Ingredient {

      // ì‹ìì¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ë° í•„ìš”í•œ ì†ì„±
      private final String id;
      private final String name;
      private final Type type;

      // ì—´ê±°í˜• íƒ€ì…
      public static enum Type{
          WRAP, PROTEIN, VEGGIES, CHEESE, SAUCE
      }
  }
  ```

        â“ @Data, @RequiredArgsConstructor ë¥¼ ì™œ ê°™ì´ì“¸ê¹Œ? Data ë§Œ ì“°ë©´ ì•ˆë˜ëŠ”ì§€?
        => @RequiredArgsConstructor ëŠ” final ì´ë‚˜ @NonNullì´ ë¶™ì€ ë³€ìˆ˜ë“¤ì„ ê°€ì§„ ìƒì„±ìë¥¼ ìƒì„±,
           @Data ëŠ” ì˜µì…˜ê°’ì´ ì—†ì„ë•Œ ìƒì„±ì, ê²Œí„°,ì„¸í„° ë“±ì„ ìƒì„±í•´ì¤€ë‹¤ : ì™œ ê°™ì´ ì“´ì§€ëŠ” ì•„ì§ ëª¨ë¥´ê² ë‹¤

  â–¶ lombok ìƒì„± ì¶œë ¥
  ![lombok](https://user-images.githubusercontent.com/65608960/118384838-84faea80-b644-11eb-8417-9dd4f7e2e90a.JPG)

- íƒ€ì½” ë””ìì¸ ì •ì˜í•˜ëŠ” ë„ë§¤ì¸ ê°ì²´ ì½”ë“œ

  ```java
  package tacos;

  import lombok.Data;
  import java.util.List;

  @Data
  public class Taco {
      private String name;
      private List<Ingredient> ingredients;
   }
  ```

#### âœ” 2.1.2 ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°

    - Controller : ìŠ¤í”„ë§ MVC í”„ë ˆì„ì›Œí¬ì˜ ì¤‘ì‹¬ì ì¸ ì—­í•  ìˆ˜í–‰
    => HTTP ìš”ì²­ì„ ì²˜ë¦¬, ë¸Œë¼ìš°ì €ì— ë³´ì—¬ì¤„ HTMLì„ ë·°ì— ìš”ì²­, REST í˜•íƒœì˜ ì‘ë‹µ ëª¸ì²´ì— ì§ì ‘ ë°ì´í„° ì¶”ê°€

    ğŸˆì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìˆ˜í–‰í•  ê¸°ëŠ¥
    - ìš”ì²­ ê²½ë¡œê°€ /designì¸ HTTP GET ìš”ì²­ ì²˜ë¦¬
    - ì‹ìì¬ ë‚´ì—­ ìƒì„±
    - ì‹ìì¬ ë°ì´í„°ì˜ HTML ì‘ì„±ì„ ë·° í…í”Œë¦¿ì— ìš”ì²­, ì‘ì„±ëœ HTMLì„ ì›¹ ë¸Œë¼ìš°ì €ì— ì „ì†¡

- ìŠ¤í”„ë§ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ ì½”ë“œ

  ```java
  package tacos.web;

  import java.util.ArrayList;
  import java.util.List;
  import java.util.stream.Collectors;
  import org.springframework.stereotype.Controller;
  import org.springframework.ui.Model;
  import org.springframework.web.bind.annotation.*;

  import lombok.extern.slf4j.Slf4j;
  import tacos.Taco;
  import tacos.Ingredient;
  import tacos.Ingredient.Type;

  // @Slf4j : Logger ìƒì„±
  @Slf4j

  // @Controller : í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ì‹ë³„ë˜ê²Œ í•˜ë©° ì»´í¬ë„ŒíŠ¸ ê²€ìƒ‰ì„ í•´ì•¼í•œë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ„
  // => ìŠ¤í”„ë§ì´ í•´ë‹¹í´ë˜ìŠ¤ë¥¼ ì°¾ì€í›„ ìŠ¤í”„ë§ APPì»´í…ìŠ¤íŠ¸ì˜ ë¹ˆ(Bean)ìœ¼ë¡œ í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìë™ ìƒì„±í•œë‹¤
  @Controller

  // @RequestMapping : í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì²˜ë¦¬í•˜ëŠ” ìš”ì²­ì˜ ì¢…ë¥˜
  // ìš”ì²­ ê²½ë¡œê°€ disign ì¸ HTTP GET ìš”ì²­ ì²˜ë¦¬
  @RequestMapping("/design")

  public class DesignTacoController {

      // @GetMapping : /disignì˜ HTTP GET ìš”ì²­ì´ ìˆ˜ì‹ ë  ë•Œ ê·¸ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ showDesignForm() ë©”ì„œë“œê°€ í˜¸ì¶œ ë˜ëŠ”ê²ƒì„ ë‚˜íƒ€ë‚¸ë‹¤
      @GetMapping

      // ì‹ìì¬ ë‚´ì—­ ìƒì„± => ì‹ìì¬ì˜ ë‚´ì—­(ìœ í˜•)ì„ List ì—ì„œ í•„í„°ë§(filterByType ë©”ì„œë“œ) í•œ í›„
      // showDesignForm()ì˜ ì¸ìë¡œ ì „ë‹¬ë˜ëŠ” Model ê°ì²´ì˜ ì†ì„±ìœ¼ë¡œ ì¶”ê°€í•œë‹¤
      // Model : ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ëŠ” ë·° ì‚¬ì´ì—ì„œ ë°ì´í„°ë¥¼ ìš´ë°˜í•˜ëŠ” ê°ì²´
      public String showDesignForm(Model model){

          // Ingredient ê°ì²´ ì €ì¥í•˜ëŠ” List ìƒì„±
         List<Ingredient> ingredients = Arrays.asList(
                  new Ingredient("FLTO", "Flour Tortilla", Type.WRAP),
                  new Ingredient("COTO", "Corn Tortilla", Type.WRAP),
                  new Ingredient("GRBF", "Ground Beef", Type.PROTEIN),
                  new Ingredient("CARN", "Carnitas", Type.PROTEIN),
                  new Ingredient("TMTO", "Diced Tomatoes", Type.VEGGIES),
                  new Ingredient("LETC", "Lettuce", Type.VEGGIES),
                  new Ingredient("CHED", "Cheddar", Type.CHEESE),
                  new Ingredient("JACK", "Monterrey Jack", Type.CHEESE),
                  new Ingredient("SLSA", "Salsa", Type.SAUCE),
                  new Ingredient("SRCR", "Sour Cream", Type.SAUCE)
          );

          // types ë³€ìˆ˜ì— íƒ€ì½” ì‹ìì¬ ì •ì˜ ì½”ë“œì˜ Typeë¥¼ ëŒ€ì…
          Type[] types = Type.values();
          for(Type type : types){
              model.addAttribute(type.toString().toLowerCase(),
                      filterByType(ingredients, type));
          }
          model.addAttribute("taco",new Taco());
          // design ì„ ë¦¬í„´ í•œë‹¤ => ëª¨ë¸ ë°ì´í„°ë¥¼ ë¸Œë¼ìš°ì €ì— ë‚˜íƒ€ë‚˜ëŠ” ë° ì‚¬ìš©ë  ë·°ì˜ ë…¼ë¦¬ì ì¸ ì´ë¦„
          return "design";
      }

      private List<Ingredient> filterByType(List<Ingredient> ingredients, Type type) {
          // ingredientsë¥¼ stream ìœ¼ë¡œ ì¹˜í™˜ -> typeê³¼ ë¦¬ìŠ¤íŠ¸ì˜ íƒ€ì…ì´ ê°™ìœ¼ë©´ -> ê°™ì€ íƒ€ì…ë¼ë¦¬ ë­‰ì³ë†“ëŠ”ë‹¤
          return ingredients.stream().filter(x -> x.getType().equals(type))
                  .collect(Collectors.toList());
      }
  }

  ```

      â“ @RequestMapping, @GetMapping ê¼­ ê°™ì´ì¨ì•¼í•˜ëŠ”ì§€ ?
      => @RequestMapping ì€ í´ë˜ìŠ¤ ê°œë…(/designì˜ ì „ì²´ì ì¸ê²ƒ)  @GetMapping ëŠ” ì„¸ë¶€ì ì¸ ê°œë…ì´ë‹¤(/design ì˜ ì„¸ë¶€ì‚¬í•­)
         @RequestMapping ì„ ì•ˆí•´ì£¼ë©´ @GetMapping í• ë•Œ ì•ì— ë§¤ë²ˆ /design ê²½ë¡œê¹Œì§€ ë¶™í˜€ì¤˜ì•¼í•œë‹¤
      â“ @Slf4j : Loggerë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”?
      => êµ¬ê°„ì²´í¬ í•˜ë ¤ê³  -> System.out.print ì‚¬ìš© í•˜ë©´ ë˜ëŠ”ê±°ì•„ë‹Œê°€ ?
         -> Logger ëŠ” debug, info, warn, error, fatal ë¡œ ë‚˜ëˆ„ì–´ ì–´ë–¤ê³³ì— ë¬¸ì œê°€ ìˆëŠ”ì§€ í‘œì‹œëœë‹¤
            sout ëŠ” ì–´ë–¤ë¬¸ì œì¸ì§€ í‘œì‹œê°€ ë˜ì§€ ì•Šê¸°ë•Œë¬¸ì— Loggerë¥¼ ì‚¬ìš©í•œë‹¤

#### âœ” 2.1.3 ë·° ë””ìì¸ í•˜ê¸°

    - ìŠ¤í”„ë§ì—ì„œ ë·°ë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²• : JSP,Thymeleaf, FreeMarker, Mustache, ê·¸ë£¨ë¹„ ê¸°ë°˜ì˜ í…œí”Œë¦¿ ë“±
    => Thymeleaf ì‚¬ìš© !

### âœ” 2.2 í¼ ì œì¶œ ì²˜ë¦¬í•˜ê¸°

    - /design ê²½ë¡œì˜ POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ìƒˆë¡œìš´ ë©”ì„œë“œ ì‘ì„±

- @PostMappingì„ ì‚¬ìš©í•´ POST ìš”ì²­ ì²˜ë¦¬ ì¶”ê°€ ì½”ë“œ

  ```java

  package tacos.web;

  import java.util.ArrayList;
  import java.util.List;
  import java.util.stream.Collectors;
  import org.springframework.stereotype.Controller;
  import org.springframework.ui.Model;
  import org.springframework.web.bind.annotation.*;

  import lombok.extern.slf4j.Slf4j;
  import tacos.Taco;
  import tacos.Ingredient;
  import tacos.Ingredient.Type;

  // @RequestMapping : í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì²˜ë¦¬í•˜ëŠ” ìš”ì²­ì˜ ì¢…ë¥˜
  // ìš”ì²­ ê²½ë¡œê°€ disign ì¸ HTTP GET ìš”ì²­ ì²˜ë¦¬
  @RequestMapping("/design")
  public class DesignTacoController {

      // /design ê²½ë¡œì˜ POST ìš”ì²­ì„ ì²˜ë¦¬ => taco ë¥¼ ë””ìì¸ í•˜ëŠ” ì‚¬ìš©ìê°€ ì œì¶œí•œ ê²ƒì„ ì—¬ê¸°ì—ì„œ ì²˜ë¦¬í•œë‹¤
      @PostMapping
      // processDesign() ë©”ì„œë“œì—ì„œëŠ” taco ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ ì–´ë–¤ ê²ƒì´ë“  ì›í•˜ëŠ” ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤

      public String processDesign(Taco design){

          log.info("Processing design: " + design);

          // redirect : processDesign()ì˜ ì‹¤í–‰ì´ ëë‚œ í›„ ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ê°€ /orders/current ìƒëŒ€ ê²½ë¡œë¡œ ì¬ì ‘ì†ë˜ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¸ë‹¤
          return "redirect:/orders/current";
      }
  }
  ```

      â“ redirect ëŒ€ì‹  forwardë¥¼ ì¨ë„ ë˜ëŠ”ì§€?
       => ëœë‹¤!-> redirect ì™€ forwardì˜ ì°¨ì´ì 
       -> redirect : URL ì£¼ì†Œê°€ ë°”ë€ë‹¤ (ì„¸ì…˜ ì •ë³´ ìœ ì§€ê°€ ì•ˆëœë‹¤)
       -> forward : IRL ì£¼ì†Œê°€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤ (ì„¸ì…˜ ì •ë³´ ìœ ì§€ê°€ ëœë‹¤)

  â• ì°¸ê³  : <https://doublesprogramming.tistory.com/63>

- íƒ€ì½” ì£¼ë¬¸ í¼ì„ ë‚˜íƒ€ë‚´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì½”ë“œ

  ```java

    package tacos.web;

    import lombok.extern.slf4j.Slf4j;
    import org.springframework.stereotype.Controller;
    import org.springframework.ui.Model;
    import org.springframework.web.bind.annotation.GetMapping;
    import org.springframework.web.bind.annotation.RequestMapping;
    import tacos.Order;

    @Slf4j
    @Controller
    // @RequestMapping : /orders ë¡œ ì‹œì‘ë˜ëŠ” ê²½ë¡œì˜ ìš”ì²­ì„ ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ìš”ì²­ ì²˜ë¦¬ ë©”ì„œë“œê°€ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜
    @RequestMapping("/orders")

    public class OrderController {

        @GetMapping("/current")
        public String orderForm(Model model) {
            model.addAttribute("order", new Order());
            return "orderForm";
        }
    }

  ```

- íƒ€ì½” ì£¼ë¬¸ ì œì¶œ ì²˜ë¦¬ ì¶”ê°€ ì½”ë“œ

  ```java

    package tacos.web;

    import lombok.extern.slf4j.Slf4j;
    import org.springframework.stereotype.Controller;
    import org.springframework.ui.Model;
    import org.springframework.web.bind.annotation.GetMapping;
    import org.springframework.web.bind.annotation.PostMapping;
    import org.springframework.web.bind.annotation.RequestMapping;
    import tacos.Order;

    @Slf4j
    @Controller
    // @RequestMapping : /orders ë¡œ ì‹œì‘ë˜ëŠ” ê²½ë¡œì˜ ìš”ì²­ì„ ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ìš”ì²­ ì²˜ë¦¬ ë©”ì„œë“œê°€ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜
    @RequestMapping("/orders")

    public class OrderController {

      @PostMapping
        // processOrder() ë©”ì„œë“œëŠ”  SessionStatusë¥¼ ì¸ìë¡œ ì „ë‹¬ë°›ì•„
        // setComplete() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì„¸ì…˜ì„ ì¬ì„¤ì • í•œë‹¤
      public String processOrder(Order order) {

            log.info("Order submitted: " + order);

            // orderForm ì„ ë¦¬í„´í•œë‹¤
            return "orderForm";
        }
    }
  ```

- íƒ€ì½” ì£¼ë¬¸ ì •ë³´ë¥¼ ê°–ëŠ” ë„ë§¤ì¸ ê°ì²´ ì½”ë“œ

  ```java

    package tacos;

    import lombok.Data;

    @Data
    public class Order  {

        private String deliveryName;
        private String deliveryStreet;
        private String deliveryCity;
        private String deliveryState;
        private String deliveryZip;
        private String ccNumber;
        private String ccExpiration;
        private String ccCVV;
    }

  ```
