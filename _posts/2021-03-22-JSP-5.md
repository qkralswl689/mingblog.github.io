---
layout: post
title: "JSP - JSP 2.3 & Servlet3.1 - response, pageContext,session   "
date: 2021-03-22
category : [JSP]
comments: true
---

## 🔷 JSP 2.3 & Servlet3.1 - response, pageContext,session  

✔  respones 객체

    - 클라이언트의 요청에 대한 HTTP 응답을 나타내는 객체

💡 response 객체의 주요 메소드들
![resp](https://user-images.githubusercontent.com/65608960/112094143-0eaab080-8bde-11eb-833f-b18b41279f70.JPG)

🖋 response 예제)

- 화면생성 및 액션 연결 코드
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>response 객체</title>
    </head>
    <body>
    JSP 환경 설정을 위한 다운로드 페이지 입니다.
    /* response2액션 상용, get방식 이용 */
    <form action="response2.jsp" method="get">
    /* select 이름 : downLoad */
    <select name="download">
        <%-- select형식 옵션 사용 */
        <option selected value="1">JDK</option>
        <option value="2">Tomcat</option>
        <option value="3">eclipes</option>
        <option vlaue="4">oracle</option>
    </select>
    /* submit 타입 버튼 생성, 버튼 이름 : 이동 */
    <input type="submit" value="이동">
    </form>
    </body>
    </html>
    ```
▶ 출력결과
![resp1](https://user-images.githubusercontent.com/65608960/112096417-90e8a400-8be1-11eb-80ec-3aedb887d8df.png)

- 액션 코드
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>response 객체 </title>
    </head>
    <body>
    <%
    /* // String타입 변수 strsite 선언후 download 파라미터 대입 */
    String strSite=request.getParameter("download");

    switch(strSite)
    /* 1 선택시  http://java.sun.com 로 이동
    response.sendRedirect 와 동일하다 */
    { case "1" : 
        out.print("<script>" +"location.href='http://java.sun.com'"+	
                "</script>" );
        break;
        /*  2선택시 바로 "http://tomcat.apache.org" 페이지로 이동 */
    case "2" :
        response.sendRedirect("http://tomcat.apache.org");
        break;
        /*  3선택시 바로 "http://www.eclipse.org" 페이지로 이동 */
    case "3":
        response.sendRedirect("http://www.eclipse.org");
        break;
        /*  기본 "http://www.oracle.com" 페이지로 이동 */
    default:
        response.sendRedirect("http://www.oracle.com");
        break;
    }
    %>
    </body>
    </html>
    ```
▶ 출력결과 (JDK 선택시)
![resp1-1](https://user-images.githubusercontent.com/65608960/112096413-90500d80-8be1-11eb-892e-3f3063b12721.JPG)

✔  pageContext 객체

    - 다른 내장 객체를 얻어내거나 현재 페이지의 요청,응답의 제어권을 다른 페이지로 넘겨주는 객체
    - 내장 객체의 속성을 제어한다

💡 pageContext 객체의 주요 메소드들
![pagecontext](https://user-images.githubusercontent.com/65608960/112099057-2dad4080-8be6-11eb-9b76-750555a20274.JPG)

🖋 pageContext 예제)

- getOut 활용
    ```js
    <%@ page language="java" contentType="text/html; charset=UTF-8" %>
    <!DOCTYPE HTML>
    <HTML lang="ko">
    <HEAD>
    <TITLE> pageContext 객체 </TITLE>
    </HEAD>
    <BODY>

    <% 
    // out. / getOut() : 결과가 같다
    out.println("회원님 환영합니다.<BR>");
    pageContext.getOut().print("마일리지를 드립니다<br>");
    pageContext.getOut().println("마일리지 100점이 지급되었습니다.<BR>");
    out.println("저희 사이트를 애용해 주셔서 감사합니다.");
    %>

    </BODY>
    </HTML>
    ```
▶ 출력결과 
![pagecontext1](https://user-images.githubusercontent.com/65608960/112100513-94335e00-8be8-11eb-94e4-45e37e22f794.JPG)

- include,flush 활용
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>pageContext 객체</title>
    </head>
    <body>
    <%
    out.print("회원님 환영합니다.<br>");
    out.flush(); // 출력버퍼 내용을 비운다

    // include : 임시적으로 지정된 페이지로 제어권을 넘긴다, 제어처리가 긑나면 원래 페이지로 제어권이 넘어온다
    pageContext.include("pageContext3.jsp");
    out.println("저희 사이트를 애용해 주셔서 감사합니다.");

    %>

    </body>
    </html>
    ```
- pageContext3 코드
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>pageContext 객체</title>
    </head>
    <body>
    <% 
    out.println("마일리지 100점을 지급해 드립니다.(pageContext3)<BR>");
    out.flush();
    %>
    </body>
    </html>
    ```
▶ 출력결과 
![pagecontext2](https://user-images.githubusercontent.com/65608960/112100515-94cbf480-8be8-11eb-8195-fa30f55bfed8.JPG)

- setAttribute, getAttribute 사용 (null 아닐경우)
    ```js
    <%@ page language="java" contentType="text/html; charset=UTF-8" %>
    <!DOCTYPE HTML>
    <HTML lang="ko">
    <HEAD>
    <TITLE> pageContext 객체 </TITLE>
    </HEAD>
    <BODY>

    <%
    // setAttribute(String name, Object value) : 이름이 name인 속성의 값을 value로 지정한다
    // setAttribute("pageValue","pageContext Example") : 이름이 pageValue인 속성의 값을 pageContext Example로 지정한다
    pageContext.setAttribute("pageValue","pageContext Example");
    Object code=pageContext.getAttribute("pageValue");

    // code가null이 아니라면
    if (code != null){
            /*읽어드린 속성은 object이므로 형변환을 해야한다 : (String)code : 문자열로 형변환  */
            // code를 String으로 형변환하여 문자열변서 strValue에 저장한다
            String strValue=(String)code;
            // strValue를 출력한다
            out.println("page Value=" + strValue + "<BR>");
    }
    else{ // null 이라면
            // 출력한다
            out.println("Not found!!");
    }
    %>

    </BODY>
    </HTML>
    ```

▶ 출력결과 
![pagecontext3](https://user-images.githubusercontent.com/65608960/112101699-6e0ebd80-8bea-11eb-91d7-6151c58aa368.JPG)


- setAttribute, getAttribute 사용 (null 일경우)
    ```js
    <%@ page language="java" contentType="text/html; charset=UTF-8" %>
    <!DOCTYPE HTML>
    <HTML lang="ko">
    <HEAD>
    <TITLE> pageContext 객체 </TITLE>
    </HEAD>
    <BODY>

    <%
    // setAttribute(String name, Object value) : 이름이 name인 속성의 값을 value로 지정한다
    // setAttribute("pageValue","pageContext Example") : 이름이 pageValue인 속성의 값을 pageContext Example로 지정한다
    pageContext.setAttribute("pageValue",null);
    Object code=pageContext.getAttribute("pageValue");

    // code가null이 아니라면
    if (code != null){
            /*읽어드린 속성은 object이므로 형변환을 해야한다 : (String)code : 문자열로 형변환  */
            // code를 String으로 형변환하여 문자열변서 strValue에 저장한다
            String strValue=(String)code;
            // strValue를 출력한다
            out.println("page Value=" + strValue + "<BR>");
    }
    else{ // null 이라면
            // 출력한다
            out.println("Not found!!");
    }
    %>

    </BODY>
    </HTML>
    ```
▶ 출력결과 
![pagecontext3-1](https://user-images.githubusercontent.com/65608960/112101697-6d762700-8bea-11eb-98c1-f94c456aa5b4.JPG)


✔ session 객체

    - 서버의 연결이 끊어져도 가상 연결을 통해 클라이언트의 정보를 유지하도록 하는 객체

💡 session 객체의 주요 메소드들
![session](https://user-images.githubusercontent.com/65608960/112101855-b4641c80-8bea-11eb-96f1-8335efc5f698.JPG)


🖋 session 예제)

- 세션 모양 코드
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>session 객체</title>
    </head>
    <body>
    // session.invalidate() : 세션 초기화 
    <% session.invalidate(); %>
    // session2의 액션 사용, post 메소드 사용 
    <FORM action="session2.jsp" Method="post">

    아이디   : <input type="text" name="strId"> <BR>
    비밀번호 : <input type="password" name="strPwd"> <BR><BR>

    <input type="submit" Value="로그인">
    <input type="reset" Value="취소">
    </Form>
    </body>
    </html>
    ```

- 세션 설정코드
    ```js
    <%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>session 객체</title>
    </head>
    <body>
    <%
    // 문자열 변수 Id 선언후 strID를 파라미터 인자로 받는다
    String Id = request.getParameter("strId");
    // 세션에 저장된 자료는 다시 getAttribute()메서드를 이용해 조회한다
    // 세션에 저장된 id를 조회해서 그 값이 null이라면
    if (session.getAttribute("sessId") == null){
        // 세션의 id를 위에서 전달받은 인자값 : 변수Id 값으로 설정한다
        session.setAttribute("sessId", Id);
    }
    //세션 유지시간은 5초로 설정
    session.setMaxInactiveInterval(5);

    // 문자열 변수 sessId선언후 세션에서 받은 sessId값을 문자형으로 형변환하여 할당한다
    String sessId=(String)session.getAttribute("sessId");

    // 문자열 변수 strSessionId 선언후 세션에서 얻은 Id값을 할당한다
    String strSessionId = session.getId();
    // 정수형 변수 intTime선언 후 세션유지시간을 할당한다
    int intTime=session.getMaxInactiveInterval();
    %>
    // sessId값 출력 
    <B> <%=sessId %> 님 환영합니다. </B> <P> 
    세션 ID : <%=strSessionId %> <BR>
    세션 시간 : <%=intTime %>

    </body>
    </html>
    ```
▶ 출력결과 
![session1](https://user-images.githubusercontent.com/65608960/112121584-bf2aab80-8c02-11eb-8735-f142bb655268.JPG)

▶ 출력결과 
![session1-1](https://user-images.githubusercontent.com/65608960/112121581-be921500-8c02-11eb-8a3b-2bdde6c3a4af.JPG)
