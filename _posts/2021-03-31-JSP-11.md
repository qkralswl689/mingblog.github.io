---
layout: post
title: "JSP - NewLecture - redirection, ê³„ì‚°ê¸°í”„ë¡œê·¸ë¨ì„ ì´ìš©í•œ ë™ì í˜ì´ì§€ ë§Œë“¤ê¸°/ì¿ í‚¤ì‚­ì œí•˜ê¸° "
date: 2021-03-31
category : [JSP]
comments: true
---

## ğŸ”· NewLecture - redirection, ê³„ì‚°ê¸°í”„ë¡œê·¸ë¨ì„ ì´ìš©í•œ ë™ì í˜ì´ì§€ ë§Œë“¤ê¸°/ì¿ í‚¤ì‚­ì œí•˜ê¸°

### âœ” redirection

    - ì„œë²„ì—ì„œ í˜ì´ì§€ë¥¼ ì „í™˜í•´ì¤€ë‹¤

### âœ” ê³„ì‚°ê¸°í”„ë¡œê·¸ë¨ì„ ì´ìš©í•œ ë™ì í˜ì´ì§€ ë§Œë“¤ê¸°/ì¿ í‚¤ì‚­ì œí•˜ê¸°

- í™”ë©´ì¶œë ¥ ì½”ë“œ
    ```java
    package newlecture;

    import java.io.IOException;
    import java.io.PrintWriter;

    import javax.servlet.ServletContext;
    import javax.servlet.ServletException;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.Cookie;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;
    import javax.servlet.http.HttpSession;

    /**
    * Servlet implementation class add
    */
    @WebServlet("/calcpage")
    public class calcPage extends HttpServlet {
        
        protected void service(HttpServletRequest request, HttpServletResponse response) throws IOException {
            
            //ì¿ í‚¤ ë°°ì—´ë³€ìˆ˜ ì„ ì–¸
                    Cookie[] cookies = request.getCookies();	
                    
            // ì¿ í‚¤ ì½ì–´ì˜¤ëŠ” ì—°ì‚°ì‹
            String exp="0";	
            if(cookies !=null) { // ì¿ í‚¤ê°€ nullì´ ì•„ë‹ê²½ìš°
                for(Cookie c : cookies) { // ì—°ì‚°ì‹ ì‹¤í–‰
                    if(c.getName().equals("exp")) {
                        exp =c.getValue();
                        break;
                        }
                    }
            }
            

            response.setCharacterEncoding("UTF-8");
            response.setContentType("text/html; charset=UTF-8");
            PrintWriter out = response.getWriter();

    // ë™ì ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤
    out.write("<!DOCTYPE html>");
    out.write("<html>");
    out.write("<head>");
    out.write("<meta charset=\"UTF-8\"> ");
    out.write("<title>calc</title>");
    out.write("<style>");
    out.write("input{");
    out.write("	width : 50px;");
    out.write("	height : 50px;");
    out.write("}");
    out.write(".output{");
    out.write("height : 50px;");
    out.write("background : #e9e9e9;");
    out.write("font-size:24px;");
    out.write("font-weight : bold;");
    out.write("text-align : right;");
    out.write("padding : 0px, 5px;");
    out.write("}");
    out.write("</style>");
    out.write("</head>");
    out.write("<body>");
    out.write("<form action=\"calc3\" method=\"post\">");
    out.write("<table>");
    out.write("<tr>");
    out.printf(		"<td class=\"output\" colspan=\"4\">%s</td>",exp); // exp ì¶œë ¥
    out.write("</tr>");
    out.write("<tr>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"CE\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"C\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"BS\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"/\" /></td>");
    out.write("</tr>");
    out.write("<tr>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"7\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"8\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"9\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"*\" /></td>");
    out.write("</tr>");
    out.write("<tr>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"4\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"5\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"6\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"-\" /></td>");
    out.write("</tr>");
    out.write("<tr>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"1\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"2\" /></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"3\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"+\" /></td>");
    out.write("</tr>");
    out.write("<tr>");
    out.write("<td></td>");
    out.write("<td><input type=\"submit\" name=\"value\" value=\"0\" /></td>");
    out.write("<td><input type=\"submit\" name=\"dot\" value=\".\" /></td>");
    out.write("<td><input type=\"submit\" name=\"operator\" value=\"=\" /></td>");
    out.write("</tr>");
    out.write("</table>");
    out.write("</form>");
    out.write("</body>");
    out.write("</html>");
        }

    }
    ```

- ê³„ì‚°ì½”ë“œ
    ```java
    package newlecture;

    import java.io.IOException;
    import java.io.PrintWriter;

    import javax.script.ScriptEngine;
    import javax.script.ScriptEngineManager;
    import javax.script.ScriptException;
    import javax.servlet.ServletContext;
    import javax.servlet.ServletException;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.Cookie;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;
    import javax.servlet.http.HttpSession;

    /**
    * Servlet implementation class add
    */
    @WebServlet("/calc3")
    public class calc3 extends HttpServlet {
        private static final long serialVersionUID = 1L;
        
        /**
        * @see HttpServlet#HttpServlet()
        */
        public calc3() {
            super();
            // TODO Auto-generated constructor stub
        }

        /**
        * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
        */
        protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
            // TODO Auto-generated method stub
            response.getWriter().append("Served at: ").append(request.getContextPath());
        }

        /**
        * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
        */
        protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
            //ì¿ í‚¤ ë°°ì—´ë³€ìˆ˜ ì„ ì–¸
            Cookie[] cookies = request.getCookies();	
            
            // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ê°€ì§€ê³ 
            String value = request.getParameter("value");
            String operator = request.getParameter("operator");
            String dot = request.getParameter("dot");
            
            // ì¿ í‚¤ë¥¼ ë§Œë“¤ì–´ expë¡œ ì „ë‹¬í•œë‹¤
            String exp ="";
            // ì¿ í‚¤ ì½ì–´ì˜¤ëŠ”ì—°ì‚°ì‹
            if(cookies !=null) { // ì¿ í‚¤ê°€ nullì´ ì•„ë‹ê²½ìš°
                for(Cookie c : cookies) { // ì—°ì‚°ì‹ ì‹¤í–‰
                    if(c.getName().equals("exp")) {
                        exp =c.getValue();
                        break;
                        }
                    }
            }
            if(operator !=null && operator.equals("=")) {
                
                // ê³„ì‚°
                // javaScript êµ¬ë¬¸ ì‹¤í–‰ ê°ì²´ ìƒì„±
                ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");
                try {
                    exp = String.valueOf(engine.eval(exp));
                } catch (ScriptException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }else if(operator !=null && operator.equals("C")) { // ì¿ í‚¤ ì‚­ì œ : Cë²„íŠ¼í´ë¦­ ì‹œ ì´ˆê¸°í™”
                exp = "";
            }
            else {
                // ì…ë ¥ê°’ ëˆ„ì 
                exp += (value == null) ? "" : value;
                exp += (operator == null) ? "" : operator;
                exp += (dot == null) ? "" : dot;
            }

            
            
            // ì¿ í‚¤ìƒì„±
            Cookie expCookie = new Cookie("exp",exp);
            if(operator !=null && operator.equals("C")) { // ì¡°ê±´ì— í•´ë‹¹ ë  ë•Œë§Œ
                expCookie.setMaxAge(0); // ì¿ í‚¤ì‚­ì œ(ë¸Œë¼ìš°ì €ì—ì„œ)
            }
            // ì¿ í‚¤ë¡œ ì €ì¥
            response.addCookie(expCookie);
            
            // redirection ê¸°ëŠ¥ : í˜ì´ì§€ ì´ë™ê¸°ëŠ¥ => +,-ì—°ì‚°ì‹œ ë¹ˆí˜ì´ì§€ ì „ë‹¬ë°›ì§€ì•ŠìŒ
            response.sendRedirect("calcpage");
            }
        }
    ```

â–¶ ì¶œë ¥ í™”ë©´
![ezgif com-gif-maker](https://user-images.githubusercontent.com/65608960/113118777-beb99280-924a-11eb-99a2-71769f0ffc52.gif)
