---
layout: post
title: "JAVA -JDBC í”„ë¡œê·¸ë˜ë° - DAO ì‘ì„± ë° êµ¬í˜„í´ë˜ìŠ¤ ì‘ì„±(isMember(id),isMember(id,pw)) "
date: 2021-03-15
category : [JAVA]
comments: true
---

## ğŸ”·JDBC - DAO ì‘ì„± ë° êµ¬í˜„í´ë˜ìŠ¤ ì‘ì„±(isMember(id),isMember(id,pw))


- DAO êµ¬í˜„í´ë˜ìŠ¤ ì‘ì„±
    ```java
    package com.javateam.jdbc.member.dao.Impl;

    import java.sql.Connection;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;
    import java.sql.SQLException;

    import java.util.ArrayList;
    import java.util.List;

    import com.javateam.jdbc.member.dao.MemberDao;
    import com.javateam.jdbc.member.domain.MemberVo;
    import com.javateam.jdbc.member.util.DbUtil;

    /**
    * MemberDaoì˜ êµ¬í˜„ í´ë˜ìŠ¤(concrete class)<br><br>
    * 
    *
    * ìš©ë¡€) MemberDao dao = MemberdaoImpl.getInstance();<br>
    * : ì‹±í´í„´(singleton:ë…ì‹ ì) íŒ¨í„´ ì ìš© &rarr; ë³´ì•ˆ<br><br>
    *  
    * @author mingki
    *
    */
    public class MemberDaoImpl implements MemberDao {
        
        /** DAO ê°ì²´ : ì‹±í´í„´(singleton) ìƒì„± íŒ¨í„´ ì ìš©*/
        private static MemberDaoImpl instance = null;
        private MemberDaoImpl() {}
        
        /**
        * ì‹±ê¸€í„´ ê°ì²´(DAO singleton object) ìƒì„± ë©”ì„œë“œ 
        * 
        * @return DAO ê°ì²´
        */
        public static final MemberDaoImpl getInstance() {
            // final : ì˜¤ë²„ë¼ì´ë“œ ê¸ˆì§€
            
            if(instance == null) {
                instance = new MemberDaoImpl();
            }
            return instance;
        }

        @Override
        public boolean isMember(String memberId) {
            
            // ë¦¬í„´(ë°˜í™˜ê°’) ì²˜ë¦¬
            boolean result = false;
            
            // ì‹¤í–‰ ë©”ì„œë“œëª…
            String methodName = new Exception().getStackTrace()[0].getMethodName();
            
            // DB ì—°ê²°
            Connection con = DbUtil.connect();
            
            // SQL ì²˜ë¦¬ ê°ì²´
            PreparedStatement pstmt = null;
            
            // ê²°ê³¼ì…‹ ê°ì²´
            ResultSet rs = null;
            
            // SQL êµ¬ë¬¸
            // String sql = "SELECT * FROM member WHERE member_id =?"; // 1)
            // String sql = "SELECT count(1) FROM member WHERE member_id =?"; // (O)
            // ì°¸ê³  : https://hue9010.github.io/db/select_count/
            String sql = "SELECT count(*) FROM member WHERE member_id =?";

            // SQL, ì¸ì(ì„ )ì²˜ë¦¬
            try {
                pstmt = con.prepareStatement(sql);
                
                pstmt.setString(1, memberId);
                
                // SQL ì‹¤í–‰, ì˜ˆì™¸ì²˜ë¦¬
                rs = pstmt.executeQuery();

                if(rs.next()) {
                    // rs.getString("member_Id"); // 1)
                    
                    // 1 : ì¡´ì¬, 0 : ì—†ìŒ
                    result = rs.getInt(1) == 1 ? true : false;
                    // result = true; // 1)
                }				
                
            } catch (SQLException e) {
                System.out.println(methodName + " : " + e.getMessage());
            
                // ìì›ë°˜ë‚©
            }finally {
                DbUtil.close(con, pstmt, rs);
            }
                
            // ë¦¬í„´(ë°˜í™˜)
            
            return result;
        }

        @Override
        public String isMember(String memberId, String memberPassword) {
            // ë¦¬í„´(ë°˜í™˜ê°’) ì²˜ë¦¬
            String result = "";
            
            // ì‹¤í–‰ ë©”ì„œë“œëª…  
            String methodName = new Exception().getStackTrace()[0].getMethodName();
            
            // DB ì—°ê²°
            Connection con = DbUtil.connect();
            
            // SQL ì²˜ë¦¬ ê°ì²´
            PreparedStatement pstmt = null;
            
            // ê²°ê³¼ì…‹ ê°ì²´
            ResultSet rs = null;
            
            // SQL êµ¬ë¬¸
            String sql = "SELECT count(*) FROM member WHERE member_id = ? AND member_password= ?";
            
            // SQL, ì¸ì (ì„ )ì²˜ë¦¬
            
            try {
                pstmt = con.prepareStatement(sql);
                
                pstmt.setString(1, memberId);
                pstmt.setString(2, memberPassword);
                
                
                
                // SQL ì‹¤í–‰, ì˜ˆì™¸ì²˜ë¦¬
                // hint ) isMember(String memberId)í™œìš©
                // ë‹¤ì¤‘ ì¡°ê±´ í™œìš©
                // 1) íšŒì› ì—¬ë¶€ ì ê²€
                // 1-1) íšŒì› ì—¬ë¶€ ì¼ì¹˜ => íŒ¨ìŠ¤ì›Œë“œ ì¡´ì¬ì—¬ë¶€ ì ê²€
                // 2) íŒ¨ìŠ¤ì›Œë“œ ì¼ì¹˜ ì—¬ë¶€ ì ê²€
                // 2-1) íŒ¨ìŠ¤ì›Œë“œ ì¼ì¹˜í•  ê²½ìš° ë©”ì‹œì§•
                // 2-2) íŒ¨ìŠ¤ì›Œë“œ ë¶ˆì¼ì¹˜í•  ê²½ìš° ë©”ì‹œì§•
                // 1-2) íšŒì› ì—¬ë¶€ ë¶ˆì¼ì¹˜ => ë©”ì‹œì§•ì²˜ë¦¬ 	
                
                // isMember ì¬í™œìš©
                if(this.isMember(memberId)== true) {// 1-1)
                    
                    // 2)
                    rs = pstmt.executeQuery();
                    
                    if(rs.next()) {
                        result = rs.getInt(1) == 1 ? "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì¡´ì¬í•©ë‹ˆë‹¤" :"íšŒì› íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";
                    }
                }else { // 1-2
                    result = "íšŒì› ì•„ì´ë””ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";				
                }
                
                // ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œ => ì˜ëª»ë¨
    //			if(rs.next()) {
    //				if(rs.getInt(1)==1) {
    //					if(rs.getInt(2)==1) {
    //						result += "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì¡´ì¬í•©ë‹ˆë‹¤";
    //					}else if(rs.getInt(2)==0) {
    //						result += "íšŒì› íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";
    //					}
    //				}else if(rs.getInt(1)==0) {
    //					result += "íšŒì› ì•„ì´ë””ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";
    //				}
    //			}
                
            } catch (SQLException e) {
                
                System.out.println(methodName + " : " + e.getMessage());
                
                // ìì› ë°˜ë‚©
            }finally {
                DbUtil.close(con, pstmt, rs);
            }	
            
            // ë¦¬í„´(ë°˜í™˜)		
            return result;
        }        
    }    
    ```

- isMember(id) í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤

    ```java
    package com.javateam.jdbc.member.test;

    import com.javateam.jdbc.member.dao.MemberDao;
    import com.javateam.jdbc.member.dao.Impl.MemberDaoImpl;
    /**
    * isMember ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤<br>
    * : íšŒì› ì—¬ë¶€ ì ê²€<br><br>
    * 
    * @author migki
    *
    */
    public class isMembeTest1 {

        public static void main(String[] args) {
            
            // DAO ê°ì²´ ìƒì„±
            MemberDao dao= MemberDaoImpl.getInstance();
            
            // ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì™€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì•„ì´ë”” ë‘ê°€ì§€ ê²½ìš°ë¥¼ í…ŒìŠ¤íŠ¸
            // 1) ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ë¡œ ì ê²€
            System.out.println("íšŒì› ì•„ì´ë”” ì¡´ì¬ ì—¬ë¶€(java): " + dao.isMember("java"));
            
            // 2) ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì•„ì´ë””ë¡œ ì ê²€
            System.out.println("íšŒì› ì•„ì´ë”” ì¡´ì¬ ì—¬ë¶€(spring) : " + dao.isMember("spring"));
            
            // ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œ
    //		String result = dao.isMemberByMemberId("mini2") == true ?
    //							"ì¤‘ë³µëœ ì•„ì´ë””ê°€ ìˆìŠµë‹ˆë‹¤" : "ì¤‘ë³µ ì—†ìŒ";
    //		System.out.println(result);
        }

    }
    ```
â–¶ ì¶œë ¥ í™”ë©´ 
![isMember](https://user-images.githubusercontent.com/65608960/111112851-37aac000-85a4-11eb-8d67-27641c1ac38f.JPG)


- isMember(id,pw) í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤
    ```java
    package com.javateam.jdbc.member.test;

    import com.javateam.jdbc.member.dao.MemberDao;
    import com.javateam.jdbc.member.dao.Impl.MemberDaoImpl;
    /**
    * isMember(id,pw) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤<br>
    * : íšŒì› ì¸ì¦ ì—¬ë¶€ ì ê²€ í…ŒìŠ¤íŠ¸<br><br>
    * 
    * @author migki
    *
    */
    public class isMembeTest2 {

        public static void main(String[] args) {
            
            // DAO ê°ì²´ ìƒì„±
            MemberDao dao = MemberDaoImpl.getInstance();
            
            System.out.println("íšŒì› id,pw ì¼ì¹˜í•  ê²½ìš°: " + dao.isMember("java", "1234"));
            System.out.println("íšŒì› idì¡´ì¬ but pw ë¶ˆì¼ì¹˜ í•  ê²½ìš° : " + dao.isMember("java", "1111"));
            System.out.println("íšŒì› ì•„ì´ë”” (spring) ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° : " + dao.isMember("spring", "1111"));
            
            // ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œ
    //		String result = dao.isMemberByMemberId("mini2") == true ?
    //							"ì¤‘ë³µëœ ì•„ì´ë””ê°€ ìˆìŠµë‹ˆë‹¤" : "ì¤‘ë³µ ì—†ìŒ";
    //		System.out.println(result);
        }

    }
    ```

â–¶ ì¶œë ¥ í™”ë©´ 
![isMember2](https://user-images.githubusercontent.com/65608960/111112848-36799300-85a4-11eb-9a91-58f716a1ca34.JPG)

